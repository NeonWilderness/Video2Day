$(document).ready(function(){var t=$(".sidebarItem:first");$.get("/topics/Sch%C3%B6ner+Bloggen/",function(e){var i="",o='<div class="sideHistoryItem clearfix"><div class="sideHistoryTitle">{tip}</div></div>';$(e).find(".storyTitle").each(function(){i+=o.replace("{tip}",$(this).html().replace("Twoday-",""))}),i.length>0&&(t.find("h4").text("Twoday-Tipps"),t.find(".sidebarItemBody").html(i),$(".sidebarItem:gt(0)").hide(0))});var e=$("#prependStory");e.closest(".story").prepend(e.html());var i="1.33333",o="1.77777",r={txtIframe:ko.observable(""),errIframe:ko.observable(""),fldProvider:ko.observable("youtube"),selWidth:ko.observable("full"),txtPixel:ko.observable("").extend({rateLimit:{method:"notifyWhenChangesStop",timeout:400}}),focusPixel:function(){return $("#txtPixel").focus(),!0},selRatio:ko.observable(o),txtRatio:ko.observable(o).extend({rateLimit:{method:"notifyWhenChangesStop",timeout:400}}),setRatio:function(){var t=this.selRatio();return"custom"===t?(this.txtRatio(""),$("#txtRatio").focus()):this.txtRatio(t),!0},txtVideo:ko.observable("").extend({rateLimit:{method:"notifyWhenChangesStop",timeout:400}}),chkPoster:ko.observable(!1),fldImage:ko.observable("jpg"),resetPoster:function(){this.chkPoster(!1),this.fldImage("jpg")},resetOptions:function(){this.txtIframe(""),this.fldProvider("youtube"),this.selWidth("full"),this.txtPixel(""),this.selRatio(o),this.txtRatio(""),this.txtVideo(""),this.resetPoster()},genError:function(t){return'<span class="error" style="margin-bottom:0">'+t+"</span>"},provider:[{option:"youtube",id:"youtube.com",vmatch:"\\/embed\\/(.*)"},{option:"vimeo",id:"vimeo.com",vmatch:"\\/video\\/(.*)"},{option:"vevo",id:"vevo.com",vmatch:"\\?video=(.*)\\&"},{option:"dailymotion",id:"dailymotion.com",vmatch:"\\/video\\/(.*)"},{option:"putpat",id:"putpat.tv",vmatch:"-(.*)"},{option:"bliptv",id:"blip.tv",vmatch:"\\/play\\/(.*)\\?"},{option:"funnyordie",id:"funnyordie.com",vmatch:"\\/embed\\/(.*)"},{option:"liveleak",id:"liveleak.com",vmatch:"f=(.*)"},{option:"vine",id:"vine.co",vmatch:"\\/v\\/(.*)\\/embed"},{option:"metacafe",id:"metacafe.com",vmatch:"\\/embed\\/(.*)\\/"},{option:"myvideo",id:"myvideo.de",vmatch:"\\/embed\\/(.*)"}]};r.txtIframe.subscribe(function(t){var e=this;try{var r=$("<div>").html(t).find("iframe").eq(0),s=(Math.round(parseInt(r.attr("width"))/parseInt(r.attr("height"))*1e5)/1e5).toString(),n=r.attr("src"),d=!1;$.each(this.provider,function(){return n.indexOf(this.id)>=0?(e.fldProvider(this.option),s===i||s===o?e.selRatio(s):(e.selRatio("custom"),e.txtRatio(s)),d=n.match(new RegExp(this.vmatch,""))||[],d.length>1&&e.txtVideo(d[1]),!1):void 0}),e.errIframe(d?"":e.genError("Der iframe-Einbettungscode konnte nicht interpretiert werden (unbekannter Anbieter)!"))}catch(a){e.errIframe(0===t.length?"":e.genError("Während der Analyse des iframe-Codes wurde ein Fehler festgestellt! Bitte kopieren Sie den vollständigen Einbettungscode des Videos inkl. &lt;iframe&gt;...&lt;/iframe&gt;"))}},r),r.fldProvider.subscribe(function(t){"other"!==t&&this.resetPoster()},r),r.txtPixelEnabled=ko.computed(function(){return"pixel"===this.selWidth()},r),r.txtRatio.subscribe(function(t){t.indexOf(",")>=0&&this.txtRatio(parseFloat(t.replace(/\,/g,".")).toString())},r),r.txtRatioEnabled=ko.computed(function(){return"custom"===this.selRatio()},r),r.labelVideo=ko.computed(function(){return"Video-"+("other"===this.fldProvider()?"URL:":"ID:")},r),r.chkPosterEnabled=ko.computed(function(){return"other"===this.fldProvider()},r),ko.computed(function(){var t='&lt;div class="html5video #cls" id="#id"&gt;&lt;/div&gt;',e=$("#fldVideoCode"),i=$("#fldVideoDisplay"),r=[this.fldProvider()],s=this.txtVideo();if(e.html(""),i.html(""),"pixel"===this.selWidth()){if(!$.isNumeric(this.txtPixel()))return i.html(this.genError("Bitte geben Sie eine gültige Breite in Pixel ein!")),void 0;r.push("width-"+this.txtPixel())}return"custom"!==this.selRatio()||$.isNumeric(this.txtRatio())?(this.selRatio()!==o&&r.push("ratio-"+this.txtRatio()),this.chkPosterEnabled()&&this.chkPoster()&&(r.push("poster"),"jpg"!==this.fldImage()&&r.push("image-"+this.fldImage())),0===s.length?(i.html(this.genError("Bitte geben Sie eine gültige Video-"+("other"===this.fldProvider()?"URL":"ID")+" ein!")),void 0):(t=t.replace("#cls",r.join(" ")).replace("#id",s),e.html('<pre class="html">'+t+"</pre>").find(".html").snippet("html",{style:"golden",showNum:!1}),i.html(t.replace(/&lt;/gi,"<").replace(/&gt;/gi,">")),$(".html5video").video2day().init({addFlexVideoClass:!1}),void 0)):(i.html(this.genError("Bitte machen Sie eine gültige Angabe für das gewünschte Aspektverhältnis!")),void 0)},r),ko.applyBindings(r);var s=location.search.length>0?decodeURIComponent(location.search).substr(1).split("&"):[];$.each(s,function(){var t=this.split("=");if(t.length<2)return!0;switch(t[0]){case"provider":r.fldProvider(t[1]);break;case"videoid":r.txtVideo(t[1])}})});